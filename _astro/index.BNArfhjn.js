import{r as s}from"./index.0yr9KlQE.js";import{P as m,f as y,h as H}from"./index.KiNWcTvd.js";import{u as x}from"./index.B7WwCSsC.js";import{j as b}from"./jsx-runtime.D_zvdyIk.js";function D(t){const e=s.useRef(t);return s.useEffect(()=>{e.current=t}),s.useMemo(()=>(...n)=>e.current?.(...n),[])}function U(t,e=globalThis?.document){const n=D(t);s.useEffect(()=>{const o=r=>{r.key==="Escape"&&n(r)};return e.addEventListener("keydown",o,{capture:!0}),()=>e.removeEventListener("keydown",o,{capture:!0})},[n,e])}var j="DismissableLayer",h="dismissableLayer.update",M="dismissableLayer.pointerDownOutside",z="dismissableLayer.focusOutside",R,T=s.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),K=s.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:o,onPointerDownOutside:r,onFocusOutside:u,onInteractOutside:f,onDismiss:d,...E}=t,a=s.useContext(T),[c,B]=s.useState(null),l=c?.ownerDocument??globalThis?.document,[,F]=s.useState({}),N=x(e,i=>B(i)),P=Array.from(a.layers),[A]=[...a.layersWithOutsidePointerEventsDisabled].slice(-1),W=P.indexOf(A),O=c?P.indexOf(c):-1,k=a.layersWithOutsidePointerEventsDisabled.size>0,L=O>=W,_=X(i=>{const v=i.target,C=[...a.branches].some(p=>p.contains(v));!L||C||(r?.(i),f?.(i),i.defaultPrevented||d?.())},l),w=q(i=>{const v=i.target;[...a.branches].some(p=>p.contains(v))||(u?.(i),f?.(i),i.defaultPrevented||d?.())},l);return U(i=>{O===a.layers.size-1&&(o?.(i),!i.defaultPrevented&&d&&(i.preventDefault(),d()))},l),s.useEffect(()=>{if(c)return n&&(a.layersWithOutsidePointerEventsDisabled.size===0&&(R=l.body.style.pointerEvents,l.body.style.pointerEvents="none"),a.layersWithOutsidePointerEventsDisabled.add(c)),a.layers.add(c),g(),()=>{n&&a.layersWithOutsidePointerEventsDisabled.size===1&&(l.body.style.pointerEvents=R)}},[c,l,n,a]),s.useEffect(()=>()=>{c&&(a.layers.delete(c),a.layersWithOutsidePointerEventsDisabled.delete(c),g())},[c,a]),s.useEffect(()=>{const i=()=>F({});return document.addEventListener(h,i),()=>document.removeEventListener(h,i)},[]),b.jsx(m.div,{...E,ref:N,style:{pointerEvents:k?L?"auto":"none":void 0,...t.style},onFocusCapture:y(t.onFocusCapture,w.onFocusCapture),onBlurCapture:y(t.onBlurCapture,w.onBlurCapture),onPointerDownCapture:y(t.onPointerDownCapture,_.onPointerDownCapture)})});K.displayName=j;var V="DismissableLayerBranch",Y=s.forwardRef((t,e)=>{const n=s.useContext(T),o=s.useRef(null),r=x(e,o);return s.useEffect(()=>{const u=o.current;if(u)return n.branches.add(u),()=>{n.branches.delete(u)}},[n.branches]),b.jsx(m.div,{...t,ref:r})});Y.displayName=V;function X(t,e=globalThis?.document){const n=D(t),o=s.useRef(!1),r=s.useRef(()=>{});return s.useEffect(()=>{const u=d=>{if(d.target&&!o.current){let E=function(){S(M,n,a,{discrete:!0})};const a={originalEvent:d};d.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=E,e.addEventListener("click",r.current,{once:!0})):E()}else e.removeEventListener("click",r.current);o.current=!1},f=window.setTimeout(()=>{e.addEventListener("pointerdown",u)},0);return()=>{window.clearTimeout(f),e.removeEventListener("pointerdown",u),e.removeEventListener("click",r.current)}},[e,n]),{onPointerDownCapture:()=>o.current=!0}}function q(t,e=globalThis?.document){const n=D(t),o=s.useRef(!1);return s.useEffect(()=>{const r=u=>{u.target&&!o.current&&S(z,n,{originalEvent:u},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,n]),{onFocusCapture:()=>o.current=!0,onBlurCapture:()=>o.current=!1}}function g(){const t=new CustomEvent(h);document.dispatchEvent(t)}function S(t,e,n,{discrete:o}){const r=n.originalEvent.target,u=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),o?H(r,u):r.dispatchEvent(u)}function te(t){const e=s.useRef({value:t,previous:t});return s.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var G=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),J="VisuallyHidden",I=s.forwardRef((t,e)=>b.jsx(m.span,{...t,ref:e,style:{...G,...t.style}}));I.displayName=J;var se=I;export{K as D,se as R,G as V,te as a,D as u};
